/**
 * @license
 * Copyright (c) 2023 The Nuevodevel Team. All rights reserved.
 * Thumbnails Plugin for Video.js v8
 */
!function(){var e={align:"vertical",timeTooltip:!0,width:160,height:90,basePath:"",src:"",responsive:!1,mediaqueries:{tiny:.5,small:.75,medium:1,large:1.25,xlarge:1.5}},t=function(){var e,s,r,o,i;for(r in s=(e=Array.prototype.slice.call(arguments)).shift()||{},e)for(i in o=e[r])o.hasOwnProperty(i)&&("object"==typeof o[i]?s[i]=t(s[i],o[i]):s[i]=o[i]);return s},s=function(t){var s,r,o;if(-1===(r=t.indexOf("#")))return{src:t,w:0,h:0,x:0,y:0};if(s=t.substring(0,r),"xywh="!==(o=t.substring(r+1)).substring(0,5))return{src:e.basePath+s,w:0,h:0,x:0,y:0};var i=o.substring(5).split(",");return{src:e.basePath+s,w:parseInt(i[2]),h:parseInt(i[3]),x:parseInt(i[0]),y:parseInt(i[1])}};videojs.registerPlugin("thumbnails",function(r){var o,n,a,d,l,h,u,c,v,m,p,f,g,y;function w(e){const t=function(e){const t=e.split("."),s=t[0].split(":");return{milliseconds:parseInt(t[1],10)||0,seconds:parseInt(s.pop(),10)||0,minutes:parseInt(s.pop(),10)||0,hours:parseInt(s.pop(),10)||0}}(e);return parseInt(3600*t.hours+60*t.minutes+t.seconds+t.milliseconds/1e3,10)}function b(e){fetch(e).then(e=>e.text()).then(e=>{if(e.length>0){var t=function(e){var t=[];return e.split(/[\r\n][\r\n]/i).forEach(function(e){if(e.match(/([0-9]{2}:)?([0-9]{2}:)?[0-9]{2}(.[0-9]{3})?( ?--> ?)([0-9]{2}:)?([0-9]{2}:)?[0-9]{2}(.[0-9]{3})?[\r\n]{1}.*/gi)){const s=e.split(/[\r\n]/i),r=s[0].split(/ ?--> ?/i),o=r[0],i=r[1],n=s[1];t.push({startTime:w(o),endTime:w(i),text:n})}}),t}(e);t.length>0&&(y=t,x())}})}function x(){(o=document.createElement("div")).className="vjs-thumbnail-holder",(a=document.createElement("canvas")).className="vtt_canvas",a.style.position="absolute",a.style.left="0",a.style.top="0",o.appendChild(a),tooltip=document.createElement("div"),tooltip.className="vjs-thumb-tooltip",(d=document.createElement("img")).className="vjs-thumb-image",d.style.visibility="hidden",d.style.left="-500px",d.style.top="-500px",document.body.appendChild(d),o.appendChild(tooltip);var e=s(y[0].text),t=new Image;(e.src&&(t.src=e.src),c.el().appendChild(o),l.shadowSlide)&&(l.el_.querySelector(".vjs-thumb-poster")||((u=document.createElement("div")).className="vjs-thumb-poster",h=document.createElement("canvas"),u.appendChild(h),l.el_.insertBefore(u,l.el_.querySelector(".vjs-poster"))));m=l.duration(),l.on("durationchange",function(e){m=l.duration()}),l.on("loadedmetadata",function(e){m=l.duration()});var r=c.el_.querySelector(".vjs-play-progress").querySelector(".vjs-time-tooltip");r&&videojs.dom.addClass(r,"vjs-abs-hidden"),mtp=c.el().querySelector(".vjs-mouse-display"),mtp&&(mtp.style.opacity=0);var i=!1,n=Object.defineProperty({},"passive",{get:function(){return i=!0,!0}});window.addEventListener("testPassive",null,n),window.removeEventListener("testPassive",null,n),v.addEventListener("mousemove",p),v.addEventListener("mouseleave",f),v.addEventListener("mousedown",L),v.addEventListener("touchstart",S,!!i&&{passive:!1})}function j(){progressIndex(!1),o.classList.remove("vjs-thumb-show"),l.shadowSlide&&(u.removeAttribute("style"),h.width=0,h.height=0)}function E(){videojs.holderdown=!1,document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",E),j()}function L(e){progressIndex(!0),videojs.holderdown=!0,document.addEventListener("mousemove",p),document.addEventListener("mouseup",E),p(e)}e.basePath="",n=t({},e,r),l=this,r&&(r.basePath&&(e.basePath=r.basePath),r.width&&r.height&&(e.width=r.width,e.height=r.height),r.src&&l.on("ready",function(){l.trigger("medialoaded",{xml:r.src})})),l.on("medialoaded",function(t,r){y=[],c=l.controlBar.progressControl,(v=l.el_.querySelector(".vjs-progress-holder")).removeEventListener("touchstart",S),v.removeEventListener("mousemove",p),v.removeEventListener("mouseleave",f),v.removeEventListener("mousedown",L),l.sprite=!1;var i=l.el_.querySelector(".vtt_canvas");i&&i.parentNode.removeChild(i);var n=l.el_.querySelector(".vjs-thumb-tooltip");n&&n.parentNode.removeChild(n);var a=document.querySelector(".vjs-thumb-image");a&&a.parentNode.removeChild(a);var d=l.el_.querySelector(".vjs-thumbnail-holder");if(d&&d.parentNode.removeChild(d),r&&r.basePath&&(console.log("yes path"),e.basePath=r.basePath),r&&r.xml)b(r.xml);else{c=l.controlBar.progressControl,v=l.el_.querySelector(".vjs-progress-holder");var h=l.textTracks().length;if(0===h)return void(o&&videojs.dom.addClass("div","vjs-hidden"));var u=!1;for(w=0;w<h;){if("metadata"===l.textTracks()[w].kind){if(void 0===(g=l.textTracks()[w]).src)return;if(g.src)return void b(g.src);if(g.mode="hidden",u=!0,(g=l.textTracks()[w]).mode="showing",null==g.cues)return void(g.mode="hidden");var m=g&&g.cues.length;break}w++}if(1!=u)return void(o&&videojs.dom.addClass("div","vjs-hidden"));if((m=(g=l.textTracks()[w])&&g.cues.length)<1)return;var w=0;for(l.sprite=!0;w<m;){var j=g.cues[w];ctt=s(j.text),w++}y=g&&g.cues,x()}}),f=function(e){progressIndex(!1),!0!==videojs.holderdown&&o.classList.remove("vjs-thumb-show")},progressIndex=function(e){e?c.el().setAttribute("style","z-index:22"):c.el().removeAttribute("style")};function q(){v.removeEventListener("touchmove",p),v.removeEventListener("touchend",q),j()}function S(e){videojs.holderdown=!1,p(e),v.addEventListener("touchmove",p),v.addEventListener("touchend",q)}a=null,p=function(e){progressIndex(!0),e.preventDefault(),m=l.duration();var t=c.el().querySelector(".vjs-progress-holder"),r=c.el().querySelector(".vjs-play-progress"),v=t.getBoundingClientRect(),p=null;e.pageX?p=e.pageX:e.changedTouches&&(p=e.changedTouches[0].pageX||e.touches[0].clientX);var f=p-v.left;if(0==f&&videojs.holderdown&&r.offsetWidth,f<0&&(f=0),f>t.offsetWidth&&(f=t.offsetWidth),n.timeTooltip){var g=f/t.offsetWidth*m,w=o.querySelector(".vjs-thumb-tooltip");w&&(w.innerHTML=function(e,t){e=e<0?0:e;let s=Math.floor(e%60),r=Math.floor(e/60%60),o=Math.floor(e/3600);const i=Math.floor(t/60%60),n=Math.floor(t/3600);return(isNaN(e)||e===1/0)&&(o=r=s="-"),(o=o>0||n>0?o+":":"")+(r=((o||i>=10)&&r<10?"0"+r:r)+":")+(s=s<10?"0"+s:s)}(g,m))}var b=y.length;i=0;for(var x=!1;i<b;){var j=y[i];if(j.startTime<=g&&j.endTime>=g){x=!0;var E=s(j.text);break}i++}if(E&&(E.iw=E.w,E.ih=E.h,E))if(1==x){o.classList.remove("vjs-thumb-hidden");var L=!1,q=E.src.replace(/\.\.\//g,"");d.src.indexOf(q)<0&&(d.src=E.src,L=!0),0===E.w&&(E.w=n.width,d.style.width=E.w+"px"),0===E.h&&(E.h=n.height,d.style.height=E.h+"px");var S=1;if(n.responsive&&n.mediaqueries){var I=l.el_.offsetWidth;I<=320&&(S=n.mediaqueries.tiny),I>320&&I<=540&&(S=n.mediaqueries.small),I>540&&I<=1080&&(S=n.mediaqueries.medium),I>1080&&I<=1600&&(S=n.mediaqueries.large),I>1600&&(S=n.mediaqueries.xlarge)}var C=E.w*S,_=E.h*S;o.style.width===C&&o.style.height===_||(o.style.width=C+"px",o.style.height=_+"px");var P=a.getContext("2d");L?d.onload=function(){a.width=C,a.height=_,E.x=0,E.y=0,P.drawImage(d,E.x,E.y,E.w,E.h,0,0,a.width,a.height)}:E.iw>0&&E.ih>0&&(a.width=C,a.height=_,P.fillRect(0,0,C,_),P.drawImage(d,E.x,E.y,E.w,E.h,0,0,a.width,a.height));var T=C/2,N=c.el().offsetWidth,k=l.el_.querySelector(".vjs-progress-holder").offsetLeft,W=T-k;if(f+T+k>N?f=N-C:f<W?f=0:f-=W,o.style.left=parseInt(f)+"px",o.classList.add("vjs-thumb-show"),videojs.holderdown&&l.shadowSlide){l.el_.querySelector(".vjs-thumb-poster")||((u=document.createElement("div")).className="vjs-thumb-poster",h=document.createElement("canvas"),u.appendChild(h),l.el_.insertBefore(u,l.el_.querySelector(".vjs-poster")));var M=h.getContext("2d");h.width=l.el_.offsetWidth,h.height=l.el_.offsetHeight,u.style.width=h.width+"px",u.style.height=h.height+"px",M.clearRect(0,0,h.width,h.height),M.drawImage(d,E.x,E.y,E.w,E.h,0,0,h.width,h.height)}}else o.classList.add("vjs-thumb-hidden")}})}();
