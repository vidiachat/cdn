/**
 * Copyright (c) 2024 The Nuevodevel Team. All rights reserved.
 * Youtube plugin for video.js
 * Version 1.7.0
 */
/* eslint-disable */import videojs from"video.js";"undefined"!==typeof window&&(window.videojs=videojs);var _isOnMobile=videojs.browser.IS_IOS||videojs.browser.IS_NATIVE_ANDROID,Tech=videojs.getTech("Tech");class Youtube extends Tech{constructor(e,t){super(e,t);this.setPoster(e.poster);this.setSrc(this.options_.source,!0);this.setTimeout(function(){if(this.el_){this.el_.parentNode.className+=" vjs-youtube";_isOnMobile&&(this.el_.parentNode.className+=" vjs-youtube-mobile");Youtube.isApiReady?this.initYTPlayer():Youtube.apiReadyQueue.push(this)}}.bind(this))}dispose(){if(this.ytPlayer){this.ytPlayer.stopVideo&&this.ytPlayer.stopVideo();this.ytPlayer.destroy&&this.ytPlayer.destroy()}else{var e=Youtube.apiReadyQueue.indexOf(this);-1!==e&&Youtube.apiReadyQueue.splice(e,1)}this.ytPlayer=null;this.el_.parentNode.className=this.el_.parentNode.className.replace(" vjs-youtube","").replace(" vjs-youtube-mobile","");this.el_.parentNode.removeChild(this.el_);Tech.prototype.dispose.call(this)}createEl(){var e=document.createElement("div");e.setAttribute("id",this.options_.techId);e.setAttribute("style","width:100%;height:100%;top:0;left:0;position:absolute");e.setAttribute("class","vjs-tech");var t=document.createElement("div");t.appendChild(e);if(!_isOnMobile&&!this.options_.ytControls){e=document.createElement("div");e.setAttribute("class","vjs-iframe-blocker");e.setAttribute("style","position:absolute;top:0;left:0;width:100%;height:100%");e.onclick=function(){this.pause()}.bind(this);t.appendChild(e)}return t}initYTPlayer(){var t={controls:0,modestbranding:1,rel:0,showinfo:0,loop:this.options_.loop?1:0};_isOnMobile&&(this.options_.ytControls=1);"undefined"!==typeof this.options_.autohide&&(t.autohide=this.options_.autohide);"undefined"!==typeof this.options_.cc_load_policy&&(t.cc_load_policy=this.options_.cc_load_policy);"undefined"!==typeof this.options_.ytControls&&(t.controls=this.options_.ytControls);"undefined"!==typeof this.options_.disablekb&&(t.disablekb=this.options_.disablekb);"undefined"!==typeof this.options_.color&&(t.color=this.options_.color);t.controls?"undefined"!==typeof this.options_.fs&&(t.fs=this.options_.fs):t.fs=0;if(-1!==this.options_.source.src.indexOf("end=")){var e=this.options_.source.src.match(/end=([0-9]*)/);this.options_.end=parseInt(e[1])}"undefined"!==typeof this.options_.end&&(t.end=this.options_.end);"undefined"!==typeof this.options_.hl?t.hl=this.options_.hl:"undefined"!==typeof this.options_.language&&(t.hl=this.options_.language.substr(0,2));"undefined"!==typeof this.options_.iv_load_policy&&(t.iv_load_policy=this.options_.iv_load_policy);"undefined"!==typeof this.options_.list?t.list=this.options_.list:this.url&&"undefined"!==typeof this.url.listId&&(t.list=this.url.listId);"undefined"!==typeof this.options_.listType&&(t.listType=this.options_.listType);"undefined"!==typeof this.options_.modestbranding&&(t.modestbranding=this.options_.modestbranding);"undefined"!==typeof this.options_.playlist&&(t.playlist=this.options_.playlist);"undefined"!==typeof this.options_.playsinline&&(t.playsinline=this.options_.playsinline);"undefined"!==typeof this.options_.rel&&(t.rel=this.options_.rel);"undefined"!==typeof this.options_.showinfo&&(t.showinfo=this.options_.showinfo);if(-1!==this.options_.source.src.indexOf("start=")){e=this.options_.source.src.match(/start=([0-9]*)/);this.options_.start=parseInt(e[1])}"undefined"!==typeof this.options_.start&&(t.start=this.options_.start);"undefined"!==typeof this.options_.theme&&(t.theme=this.options_.theme);if("undefined"!==typeof this.options_.customVars){var i=this.options_.customVars;Object.keys(i).forEach(function(e){t[e]=i[e]})}this.activeVideoId=this.url?this.url.videoId:null;this.activeList=t.list;e={videoId:this.activeVideoId,playerVars:t,events:{onReady:this.onPlayerReady.bind(this),onPlaybackQualityChange:this.onPlayerPlaybackQualityChange.bind(this),onPlaybackRateChange:this.onPlayerPlaybackRateChange.bind(this),onStateChange:this.onPlayerStateChange.bind(this),onVolumeChange:this.onPlayerVolumeChange.bind(this),onError:this.onPlayerError.bind(this)}};"undefined"!==typeof this.options_.enablePrivacyEnhancedMode&&this.options_.enablePrivacyEnhancedMode&&(e.host="https://www.youtube-nocookie.com");this.ytPlayer=new YT.Player(this.options_.techId,e)}onPlayerReady(){this.options_.muted&&this.ytPlayer.mute();this.ytPlayer.getAvailablePlaybackRates().length>1&&(this.featuresPlaybackRate=!0);this.playerReady_=!0;this.triggerReady();if(this.playOnReady)this.play();else if(this.cueOnReady){this.cueVideoById_(this.url.videoId);this.activeVideoId=this.url.videoId}}onPlayerPlaybackQualityChange(){}onPlayerPlaybackRateChange(){this.trigger("ratechange")}onPlayerStateChange(e){e=e.data;if(e!==this.lastState&&!this.errorNumber)switch(this.lastState=e){case-1:this.trigger("loadstart");this.trigger("loadedmetadata");this.trigger("durationchange");this.trigger("ratechange");break;case YT.PlayerState.ENDED:this.trigger("ended");break;case YT.PlayerState.PLAYING:this.trigger("timeupdate");this.trigger("durationchange");this.trigger("playing");this.trigger("play");this.isSeeking&&this.onSeeked();break;case YT.PlayerState.PAUSED:this.trigger("canplay");this.isSeeking?this.onSeeked():this.trigger("pause");break;case YT.PlayerState.BUFFERING:this.player_.trigger("timeupdate");this.player_.trigger("waiting")}}onPlayerVolumeChange(){this.trigger("volumechange")}onPlayerError(e){this.errorNumber=e.data;this.trigger("pause");this.trigger("error")}error(){var e=1e3+this.errorNumber;switch(this.errorNumber){case 5:return{code:e,message:"Error while trying to play the video"};case 2:case 100:return{code:e,message:"Unable to find the video"};case 101:case 150:return{code:e,message:"Playback on other Websites has been disabled by the video owner."}}return{code:e,message:"YouTube unknown error ("+this.errorNumber+")"}}loadVideoById_(e){e={videoId:e};this.options_.start&&(e.startSeconds=this.options_.start);this.options_.end&&(e.endSeconds=this.options_.end);this.ytPlayer.loadVideoById(e)}cueVideoById_(e){e={videoId:e};this.options_.start&&(e.startSeconds=this.options_.start);this.options_.end&&(e.endSeconds=this.options_.end);this.ytPlayer.cueVideoById(e)}src(e){e&&this.setSrc({src:e});return this.source}poster(){return _isOnMobile?null:this.poster_}setPoster(e){this.poster_=e}setSrc(e){if(e&&e.src){delete this.errorNumber;this.source=e;this.url=Youtube.parseUrl(e.src);if(!this.options_.poster&&this.url.videoId){this.poster_="https://img.youtube.com/vi/"+this.url.videoId+"/0.jpg";this.trigger("posterchange");this.checkHighResPoster()}if(this.options_.autoplay&&!_isOnMobile)this.isReady_?this.play():this.playOnReady=!0;else if(this.activeVideoId!==this.url.videoId)if(this.isReady_){this.cueVideoById_(this.url.videoId);this.activeVideoId=this.url.videoId}else this.cueOnReady=!0}}autoplay(){return this.options_.autoplay}setAutoplay(e){this.options_.autoplay=e}loop(){return this.options_.loop}setLoop(e){this.options_.loop=e}play(){if(this.url&&this.url.videoId){this.wasPausedBeforeSeek=!1;if(this.isReady_){if(this.url.listId)if(this.activeList===this.url.listId)this.ytPlayer.playVideo();else{this.ytPlayer.loadPlaylist(this.url.listId);this.activeList=this.url.listId}if(this.activeVideoId===this.url.videoId)this.ytPlayer.playVideo();else{this.loadVideoById_(this.url.videoId);this.activeVideoId=this.url.videoId}}else{this.trigger("waiting");this.playOnReady=!0}}}pause(){this.ytPlayer&&this.ytPlayer.pauseVideo()}paused(){return!this.ytPlayer||this.lastState!==YT.PlayerState.PLAYING&&this.lastState!==YT.PlayerState.BUFFERING}currentTime(){return this.ytPlayer?this.ytPlayer.getCurrentTime():0}setCurrentTime(e){this.lastState===YT.PlayerState.PAUSED&&(this.timeBeforeSeek=this.currentTime());this.isSeeking||(this.wasPausedBeforeSeek=this.paused());this.ytPlayer.seekTo(e,!0);this.trigger("timeupdate");this.trigger("seeking");this.isSeeking=!0;if(this.lastState===YT.PlayerState.PAUSED&&this.timeBeforeSeek!==e){clearInterval(this.checkSeekedInPauseInterval);this.checkSeekedInPauseInterval=setInterval(function(){if(this.lastState===YT.PlayerState.PAUSED&&this.isSeeking){if(this.currentTime()!==this.timeBeforeSeek){this.trigger("timeupdate");this.onSeeked()}}else clearInterval(this.checkSeekedInPauseInterval)}.bind(this),250)}}seeking(){return this.isSeeking}seekable(){return this.ytPlayer?videojs.createTimeRange(0,this.ytPlayer.getDuration()):videojs.createTimeRange()}onSeeked(){clearInterval(this.checkSeekedInPauseInterval);this.isSeeking=!1;this.wasPausedBeforeSeek&&this.pause();this.trigger("seeked")}playbackRate(){return this.ytPlayer?this.ytPlayer.getPlaybackRate():1}setPlaybackRate(e){this.ytPlayer&&this.ytPlayer.setPlaybackRate(e)}duration(){return this.ytPlayer?this.ytPlayer.getDuration():0}currentSrc(){return this.source&&this.source.src}ended(){return!!this.ytPlayer&&this.lastState===YT.PlayerState.ENDED}volume(){return this.ytPlayer?this.ytPlayer.getVolume()/100:1}setVolume(e){this.ytPlayer&&this.ytPlayer.setVolume(100*e)}muted(){return!!this.ytPlayer&&this.ytPlayer.isMuted()}setMuted(e){if(this.ytPlayer){this.muted(!0);e?this.ytPlayer.mute():this.ytPlayer.unMute();this.setTimeout(function(){this.trigger("volumechange")},50)}}buffered(){var e;return this.ytPlayer&&this.ytPlayer.getVideoLoadedFraction?(e=this.ytPlayer.getVideoLoadedFraction()*this.ytPlayer.getDuration(),videojs.createTimeRange(0,e)):videojs.createTimeRange()}preload(){}load(){}reset(){}networkState(){if(!this.ytPlayer)return 0;switch(this.ytPlayer.getPlayerState()){case-1:return 0;case 3:return 2;default:return 1}}readyState(){if(!this.ytPlayer)return 0;switch(this.ytPlayer.getPlayerState()){case-1:return 0;case 5:return 1;case 3:return 2;default:return 4}}supportsFullScreen(){return document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled}checkHighResPoster(){var e="https://img.youtube.com/vi/"+this.url.videoId+"/maxresdefault.jpg";try{var t=new Image;t.onload=function(){if("naturalHeight"in t){if(t.naturalHeight<=90||t.naturalWidth<=120)return}else if(t.height<=90||t.width<=120)return;this.poster_=e;this.trigger("posterchange")}.bind(this);t.onerror=function(){};t.src=e}catch(e){}}}Youtube.isSupported=function(){return!0};Youtube.canPlaySource=function(e){return Youtube.canPlayType(e.type)};Youtube.canPlayType=function(e){return"video/youtube"===e};Youtube.parseUrl=function(e){var t={videoId:null},i=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/,i=e.match(i),s=(i&&11===i[2].length&&(t.videoId=i[2]),/[?&]list=([^#\&\?]+)/);(i=e.match(s))&&i[1]&&(t.listId=i[1]);return t};function apiLoaded(){YT.ready(function(){Youtube.isApiReady=!0;for(var e=0;e<Youtube.apiReadyQueue.length;++e)Youtube.apiReadyQueue[e].initYTPlayer()})}function loadScript(e,t){var i=!1,s=document.createElement("script"),o=document.getElementsByTagName("script")[0];if(o){o.parentNode.insertBefore(s,o);s.onload=function(){if(!i){i=!0;t()}};s.onreadystatechange=function(){if(!i&&("complete"===this.readyState||"loaded"===this.readyState)){i=!0;t()}};s.src=e}}function injectCss(){var e=".vjs-youtube .vjs-iframe-blocker { display: none; }.vjs-youtube.vjs-user-inactive .vjs-iframe-blocker { display: block; }.vjs-youtube .vjs-poster { background-size: cover; }.vjs-youtube-mobile .vjs-big-play-button { display: none; }",t=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.type="text/css";i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e));t.appendChild(i)}Youtube.apiReadyQueue=[];if("undefined"!==typeof document){loadScript("https://www.youtube.com/iframe_api",apiLoaded);injectCss()}"undefined"!==typeof videojs.registerTech?videojs.registerTech("Youtube",Youtube):videojs.registerComponent("Youtube",Youtube);
