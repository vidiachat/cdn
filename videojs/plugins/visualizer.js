/**
 * @license
 * Copyright (c) 2024 The Nuevodebel Team. All rights reserved.
 * Visualizer Plugin for video.js Version 1.0
 */
!function(e,t){"function"==typeof define&&define.amd?define([],t.bind(this,e,e.videojs)):"undefined"!=typeof module&&module.exports?module.exports=t(e,e.videojs):t(e,e.videojs)}(window,function(C,c){"use strict";function t(p,t){var v,y=p.el(),g=p.$(".vjs-tech"),o={video:!1,color1:"#ffcc00",color2:"#ff0000",capsColor:"#fff",caps:!1,bottom:0,height:50,f_play:!1};try{v=c.obj.merge(o,t||{})}catch(e){v=c.mergeOptions(o,t||{})}var w,n,S,j,q,A,r,b,a,l,s,e;function i(){p.el_.offsetWidth;var e=p.el_.querySelector(".vjs-visualizer"),t=p.el_.querySelector(".vjs-control-bar"),o=e.offsetHeight,i=parseInt(getComputedStyle(t).getPropertyValue("height")),t=(i+=parseInt(getComputedStyle(t).getPropertyValue("bottom")),10);p.el_.querySelector(".vjs-skin-treso")&&(t=20),p.el_.querySelector(".vjs-skin-mockup")&&(t=30),p.el_.querySelector(".vjs-skin-jwlike")&&(t=15),e.style.bottom=i-o/3+t+"px"}1==(C.AudioContext=C.AudioContext||C.webkitAudioContext,!!C.AudioContext)&&(n=null,l=!(a=!1),s=new WeakMap,o="50",t="0",0<parseInt(v.height)&&parseInt(v.height)<=100&&(o=parseInt(v.height)),0<parseInt(v.bottom)&&(t=parseInt(v.bottom)+"%"),parseInt(v.width)<=100&&10<parseInt(v.width)&&parseInt(v.width),t=".vjs-visualizer{left:0;z-index:4;position:absolute;padding:0 10px;bottom:"+t+";width:100%;height:"+o+"%;pointer-events:none;}",p.on("playerresize",function(){i()}),p.one("playing",function(){setTimeout(function(){i()},1e3)}),o=t,t=document.head||document.getElementsByTagName("head")[0],(e=document.createElement("style")).type="text/css",e.styleSheet?e.styleSheet.cssText=o:e.appendChild(document.createTextNode(o)),t.appendChild(e),(S=document.createElement("canvas")).className="vjs-visualizer",S.id="visualizer",y.insertBefore(S,p.controlBar.el_),i(),w=!1,p.on("loadeddata",function(){var e=p.currentType();w=-1<e.indexOf("audio"),v.f_play=!1,(w=v.video?!0:w)&&p.one("playing",function(){function e(e,t){e=e.replace("#","");var o=parseInt(3==e.length?e.slice(0,1).repeat(2):e.slice(0,2),16),i=parseInt(3==e.length?e.slice(1,2).repeat(2):e.slice(2,4),16),e=parseInt(3==e.length?e.slice(2,3).repeat(2):e.slice(4,6),16);return t?"rgba("+o+", "+i+", "+e+", "+t+")":"rgb("+o+", "+i+", "+e+")"}function c(){if(w){g=p.$(".vjs-tech");var e=y.querySelector(".vjs-background-bar"),t=(e&&(e.style.display="none"),b.fftSize=256,j=b.frequencyBinCount,S.width=y.offsetWidth-20,S.width/j*1.2),o=(t<6&&(t=6),1),i=(S.width<500&&(o=2),C.RequestAnimationFrame=C.requestAnimationFrame(c)||C.msRequestAnimationFrame(c)||C.mozRequestAnimationFrame(c)||C.webkitRequestAnimationFrame(c),0);q=new Uint8Array(j),b.getByteFrequencyData(q),A.clearRect(0,0,S.width,S.height);for(var n=0;n<j;n+=o){var r,a,l,n=parseInt(n),s=q[n];i+t<S.width&&((r=A.createLinearGradient(0,0,0,.5*S.height)).addColorStop(1,u),r.addColorStop(.5,f),r.addColorStop(0,f),a=S.height/1.5-s,l=S.height/1.5,A.fillStyle=r,A.fillRect(i,a,t,s),v.caps&&(m[i]?(A.fillStyle=d,a<m[i]?(m[i]=a)!=l&&A.fillRect(i,a-6,t,3):(m[i]=m[i]+1,m[i]<l&&A.fillRect(i,m[i]-6,t,3))):m[i]=a),A.fillStyle=h,A.fillRect(i,S.height/1.5,t,s/2),i+=t+4)}}else try{A.clearRect(0,0,S.width,S.height)}catch(e){}}var t,d,o,u,f,h,m,i;if(v.f_play=!0,w&&l){if(void 0!==p.currentSource().av&&(l=!1),y.querySelector(".vjs-background-bar"),a&&(a=!1,(i=p.el().querySelector("vjs-visualizer"))&&i.parentNode.removeChild(i),(S=document.createElement("canvas")).className="vjs-visualizer",S.id="visualizer",y.insertBefore(S,p.controlBar.el_),n)&&(n.close(),n=null),!n){g=p.$(".vjs-tech");try{n=new AudioContext,s.has(g)?r=s.get(g):(r=n.createMediaElementSource(g),s.set(g,r)),b=n.createAnalyser(),S.width=S.offsetWidth,S.height=3*S.height,A=S.getContext("2d"),r.connect(b),b.connect(n.destination)}catch(e){}}v.color1.indexOf("#")<0&&(v.color1="#"+v.color1),v.color2.indexOf("#")<0&&(v.color2="#"+v.color2),i="#ffcc00",t="#ff0000",d="#fff",(o=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i).test(v.capsColor)&&(d=v.capsColor),o.test(v.color1)&&(i=v.color1),o.test(v.color2)&&(t=v.color2),u=e(i),f=e(t),h=e(i,.2),m=new Array,C.RequestAnimationFrame=C.requestAnimationFrame(c)||C.msRequestAnimationFrame(c)||C.mozRequestAnimationFrame(c)||C.webkitRequestAnimationFrame(c)}})}),p.on("chromecastDisconnected",function(){a=!0}))}C.videojs_visualizer={version:"0.2"};c.registerPlugin;c.registerPlugin("visualizer",function(e){t(this,e)})});
