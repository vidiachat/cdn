/**
 * Copyright (c) 2023 The Nuevodevel Team. All rights reserved.
 * UpNext plugin for video.js
 * Version 1.2.0
 */
!function(e,n){"function"==typeof define&&define.amd?define([],n.bind(this,e,e.videojs)):"undefined"!=typeof module&&module.exports?module.exports=n(e,e.videojs):n(e,e.videojs)}(window,function(e,n){"use strict";function l(e,l,t){var i={nextTitle:"Up Next",offset:30};try{t=n.obj.merge(i,t||{})}catch(e){t=n.mergeOptions(i,t||{})}var a,r,o,d=!1,s=!1,c=t.nextTitle,u=t.offset,p=0;if(e.upnext.title=function(e){e.length>1&&(c=e)},e.upnext.offset=function(e){parseInt(e,10)>1&&(u=e)},!Array.isArray(l)&&l.title&&(l.sources||l.url)&&l.poster){var v=[];v[0]=l,l=v}if(Array.isArray(l)){for(var h=[],m=0;m<l.length;m++)if(l[m].title&&(l[m].sources||l[m].url)&&l[m].poster){var f=b("img");f.src=l[m].poster,l[m].img=f,h.push(l[m])}h.length>1?(a=h[1],p=1):a=h[0];var g=null,C=null,x=null,y=null;if(0!=h.length)return n.dom.addClass(e.el(),"vjs-up-next"),e.on("timeupdate",function(){n.dom.hasClass(e.el(),"vjs-ad-playing")||n.dom.hasClass(e.el(),"vjs-dai")||h.length<1||h.length>1&&p==h.length-1||e.duration()===1/0||"8"===n.browser.IOS_VERSION&&0===e.duration()||(!0!==d&&e.currentTime()>0&&e.duration()-e.currentTime()<u&&function(){if(!d&&!s){(g=b("div","vjs-upnext")).ariaDisabled=!1,g.tabIndex="0",g.ariaLabel=e.localize("UpNext video");var l=a.img;if(l.setAttribute("alt",a.title),g.appendChild(l),a.duration){var t=b("div","next-dur",a.duration);g.appendChild(t)}var i=b("span","upnext-right",'<span class="nextup">'+c+'</span><span class="vjs-up-title">'+a.title+"</span>");if(g.appendChild(i),a.url){var r=b("a");r.href=a.url,r.target="_blank",a.target?r.target=a.target:r.target="_blank",g.appendChild(r)}e.el().appendChild(g),setTimeout(()=>{g.className="vjs-upnext vjs-upnext-show"},500),d=!0,g.onkeydown=function(e){13===e.which&&(e.preventDefault(),e.stopPropagation(),g.click())},g.onclick=function(){r?r.click():(e.changeSource(a),g.onclick=null,e.el().removeChild(g),g=null,e.play(),1==h.length?(s=!0,n.dom.removeClass(e.el(),"vjs-up-next"),h.splice(0,1)):p<h.length-1&&(a=h[++p]))}}}(),d&&e.duration()-e.currentTime()>u&&(g&&(g.onclick=null,g.parentNode.removeChild(g),g=null),d=!1))}),e.on("ended",function(){n.dom.hasClass(e.el(),"vjs-ad-playing")||n.dom.hasClass(e.el(),"vjs-dai")||function(){if(0==h.length)return;n.dom.addClass(e.controlBar.el_,"vjs-hidden");var l=e.el().querySelector(".vjs-replay-button");l&&setTimeout(function(){l.removeAttribute("style")},100);n.dom.addClass(e.el(),"vjs-up-next"),1==h.length&&(s=!0);g&&(g.onclick=null,g.parentNode.removeChild(g),g=null);x=b("div","vjs-nextup");var t=b("div","next-header","<span>"+e.localize("Up Next")+"</span>");x.appendChild(t),C=b("div","vjs-fullnext"),x.appendChild(C);var i=b("div","respo");if(i.tabIndex=0,i.ariaDiabled=!1,i.ariaLabel=e.localize("Play")+" "+a.title,(r=b("div","img")).style.backgroundImage="url("+a.poster+")",i.appendChild(r),C.appendChild(i),a.duration){var d=b("div","full-dur",a.duration);C.appendChild(d)}var c=b("div","next-title",a.title);C.appendChild(c);var u=b("div","progress");if(u.innerHTML='<svg viewBox="0 0 84 84" preserveAspectRatio="xMinYMin meet"><circle class="circle1" cx="40" cy="40" r="40"></circle><circle id="circle2" class="circle2" cx="40" cy="40" r="40"></circle><g style="transform: translate(77%,26%) rotate(90deg) scale(3, 3);fill: #fff;"><path d="M3 12.2V3.8c0-.8.8-1.3 1.5-.9l7.1 4.2c.6.4.6 1.3 0 1.7L4.5 13c-.7.5-1.5 0-1.5-.8z"></path></g></svg>',C.appendChild(u),i.onclick=function(){a.url?((o=b("a")).href=a.url,a.target?o.target=a.target:o.target="_blank",C.appendChild(o),o.click()):(C.onclick=null,x&&(x.parentNode.removeChild(x),x=null),y&&(y.parentNode.removeChild(y),y=null),e.changeSource(a),e.play(),e.one("playing",function(l){n.dom.removeClass(e.el(),"vjs-up-next"),n.dom.removeClass(e.controlBar.el_,"vjs-hidden"),1==h.length&&(s=!0,h.splice(0,1),a=null)}),h.length>1&&p<h.length-1&&(a=h[++p]))},y=b("div","next-overlay"),e.el().appendChild(y),e.el().appendChild(x),h.length>1){var v="vjs-nav-prev",m="vjs-nav-next";0===p&&(v="vjs-nav-prev disabled"),p===h.length-1&&(m="vjs-nav-next disabled");var f=b("div",v,'<div class="icon"></div>'),j=b("div",m,'<div class="icon"></div>');f.ariaDisabled=j.ariaDisabled=!1,f.tabIndex=j.tabIndex=0,f.role=j.role="button",j.ariaLabel=e.localize("Next video"),f.ariaLabel=e.localize("Previous video"),y.appendChild(f),y.appendChild(j),j.onkeydown=function(e){13===e.which&&(e.preventDefault(),e.stopPropagation(),j.click())},j.onclick=function(){++p>h.length-1?p=h.length-1:(p===h.length-1&&n.dom.addClass(j,"disabled"),n.dom.removeClass(f,"disabled"),N(p,"next"))},f.onkeydown=function(e){13===e.which&&(e.preventDefault(),e.stopPropagation(),f.click())},f.onclick=function(){--p<0?p=0:(0===p&&n.dom.addClass(f,"disabled"),n.dom.removeClass(j,"disabled"),N(p,"prev"))};var k=b("div","next-close");function N(l,t){a=h[l];var s=b("div","img");s.style.backgroundImage="url("+h[l].poster+")",s.style.left="next"==t?"100%":"-100%";var u,p=100,v=-100;i.appendChild(s),u="next"==t?requestAnimationFrame(function e(){p-=3;if(p<=0)return cancelAnimationFrame(u),s.style.left=0,r.parentNode.removeChild(r),r=s,void(s=null);p>0&&(s.style.left=p+"%");u=requestAnimationFrame(e)}):requestAnimationFrame(function e(){v+=3;if(v>=0)return cancelAnimationFrame(u),s.style.left=0,r.parentNode.removeChild(r),r=s,void(s=null);v<0&&(s.style.left=v+"%");u=requestAnimationFrame(e)}),c.innerHTML=h[l].title,i.ariaLabel=e.localize("Play")+" "+h[l].title,o&&i.removeChild(o),h[l].duration&&d?(d.innerHTML=h[l].duration,n.dom.removeClass(d,"vjs-hidden")):d&&n.dom.addClass(d,"vjs-hidden")}k.innerHTML="&#9447;",k.tabIndex="0",k.ariaLabel=e.localize("Close UpNext container"),k.ariaDisabled=!1,x.appendChild(k),k.onkeydown=function(e){13==e.which&&(e.preventDefault(),e.stopPropagation(),k.click())},k.onclick=function(){C.onclick=null,x&&(x.parentNode.removeChild(x),x=null),y&&(y.parentNode.removeChild(y),y=null),e.play(),e.one("playing",function(l){n.dom.removeClass(e.el(),"vjs-up-next"),n.dom.removeClass(e.controlBar.el_,"vjs-hidden"),s=!0,1==h.length&&(s=!0,h.splice(0,1),a=null)})}}return}()}),this}else console.log("Error: Upnext - Invalid list array");function b(e,n,l){var t=document.createElement(e);return n&&(t.className=n),l&&(t.innerHTML=l),t}}e.videojs_upnext={version:"0.1"};(n.registerPlugin||n.plugin)("upnext",function(e,n){this.ready(function(){l(this,e,n)})})});